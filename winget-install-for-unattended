if( [System.Environment]::OSVersion.Version.Build -lt 26100 ) {
    'This script requires Windows 11 24H2 or later.' | Write-Warning;
    return;
}
$timeout = [datetime]::Now.AddMinutes( 5 );
$exe = "$env:LOCALAPPDATA\Microsoft\WindowsApps\winget.exe";

while( $true ) {
    if( $exe | Test-Path ) {
        & $exe install --exact --id Mozilla.Firefox --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Brave.Brave --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Google.Chrome --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Chocolatey.Chocolatey --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id XBMCFoundation.Kodi --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id VideoLAN.VLC --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id CodecGuide.K-LiteCodecPack.Mega --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id PowerSoftware.AnyBurn --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id ShareX.ShareX --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Zoom.Zoom --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Microsoft.VisualStudioCode --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Inkscape.Inkscape --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id GIMP.GIMP.3 --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Obsidian.Obsidian --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id qBittorrent.qBittorrent --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id 7zip.7zip --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id RARLab.WinRAR --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Google.GoogleDrive --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id SublimeHQ.SublimeText.4 --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Guru3D.Afterburner --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Rainmeter.Rainmeter --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Piriform.Speccy --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Microsoft.WindowsTerminal --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id CharlesMilette.TranslucentTB --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id DucFabulous.UltraViewer --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Rakuten.Viber --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        & $exe install --exact --id Telegram.TelegramDesktop --silent --accept-package-agreements --accept-source-agreements --source winget --scope machine;
        return;
    }
    if( [datetime]::Now -gt $timeout ) {
        'File {0} does not exist.' -f $exe | Write-Warning;
        return;
    }
    Start-Sleep -Seconds 1;
}